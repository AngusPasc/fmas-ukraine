<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Name="" Version="3.15" DotMatrixReport="False" EngineOptions.ConvertNulls="False" EngineOptions.MaxMemSize="10000000" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="1073" PreviewOptions.Zoom="1" PrintOptions.Printer="По умолчанию" ReportOptions.CreateDate="38464,5474027546" ReportOptions.Description.Text="" ReportOptions.LastChange="38693,7302388889" ScriptLanguage="PascalScript" ScriptText.Text="var FlagPrintGroupFooter:boolean=False;&#13;&#10;    PLine:integer=0;&#13;&#10;&#13;&#10;    GroupNo: Integer;               // номер группы&#13;&#10;    MHeight: array of Extended;     // массив высот заголовок группы + первая запись&#13;&#10;    LastLine: Integer;              // номер последней записи в главном наборе&#13;&#10;    FHeight: Extended;              // высота итогов&#13;&#10;    LastGroup: Integer;             // номер последней группы&#13;&#10;    LastGroupOneRow: Boolean;       // последня группа из одной строки?&#13;&#10;    NeededHeight: Extended;         // нужная высота&#13;&#10;&#13;&#10;procedure GroupFooter1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;    FlagPrintGroupFooter:=True;&#13;&#10;    PLine:=0;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure PageFooter1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;    PageFooter1.Visible := not FlagPrintGroupFooter;&#13;&#10;    FlagPrintGroupFooter:=False;&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;procedure ReportTitle1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;       // инициализировать номер группы&#13;&#10;       GroupNo := 0;&#13;&#10;       Pline:=0;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure MasterData1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  PLine := PLine+1;&#13;&#10;&#13;&#10;  with MasterData1, Engine do&#13;&#10;  begin&#13;&#10;         // проверить, одна ли строка данных в последней группе&#13;&#10;     if not FinalPass then&#13;&#10;            if &#60;Line&#62; &#62; 1 then LastGroupOneRow := False&#13;&#10;            else LastGroupOneRow := True;&#13;&#10;&#13;&#10;         // если не хватает места для последней записи&#13;&#10;         // с итогами, сформировать новую страницу&#13;&#10;     if FinalPass then&#13;&#10;        if ( &#60;Line#&#62; =  LastLine )&#13;&#10;           and ( FreeSpace &#60; Height + FHeight )&#13;&#10;        then NewPage;&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure MasterData1OnAfterCalcHeight(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;       with MasterData1, Engine do&#13;&#10;       begin&#13;&#10;              // 1й проход: прибавить к высоте заголовка группы&#13;&#10;              // высоту первой записи&#13;&#10;          if not FinalPass and (&#60;Line&#62; = 1) then&#13;&#10;             MHeight[GroupNo] := MHeight[GroupNo] + Height;&#13;&#10;&#13;&#10;                // 1й проход: обновить общее количество записей&#13;&#10;          if not FinalPass then&#13;&#10;               LastLine := &#60;Line#&#62;;&#13;&#10;       end;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure GroupHeader1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with GroupHeader1, Engine do&#13;&#10;  begin&#13;&#10;         // увеличить номер группы&#13;&#10;     inc(GroupNo);&#13;&#10;         // обновить номер последней группы&#13;&#10;     if not FinalPass then LastGroup := GroupNo;&#13;&#10;&#13;&#10;         // 2й проход: если не хватает места для&#13;&#10;         // заголовка группы и первой записи,&#13;&#10;         // перейти на следующую страницу&#13;&#10;         // а если группа последняя, и только одна&#13;&#10;         // строка с данными, проверить, хватит ли&#13;&#10;         // места для группы, данных и итогов&#13;&#10;     if FinalPass then&#13;&#10;     begin&#13;&#10;       NeededHeight := MHeight[GroupNo];&#13;&#10;       if ( GroupNo = LastGroup ) and LastGroupOneRow then&#13;&#10;               NeededHeight := NeededHeight + FHeight;&#13;&#10;&#13;&#10;       if FreeSpace &#60; NeededHeight then NewPage;&#13;&#10;     end;&#13;&#10;  end;&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;procedure GroupHeader1OnAfterCalcHeight(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;       with GroupHeader1, Engine do&#13;&#10;       begin&#13;&#10;            // 1й проход: запомнить высоту заголовка группы&#13;&#10;            if not FinalPass then&#13;&#10;            begin&#13;&#10;                SetLength(MHeight, GroupNo+1);&#13;&#10;                MHeight[GroupNo] := Height;&#13;&#10;            end;&#13;&#10;       end;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure ReportSummary1OnAfterCalcHeight(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;     // 1й проход: запомнить высоту итогов&#13;&#10;     with Engine, ReportSummary1 do&#13;&#10;     if not FinalPass and Visible then&#13;&#10;        FHeight := Height;&#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end." PropData="044C65667403A80008446174617365747301010C3600000020446174615365743D225265706F727444736574446174612220446174615365744E616D653D225265706F727444736574446174612200010C4200000020446174615365743D225265706F727444536574476C6F62616C446174612220446174615365744E616D653D225265706F727444736574476C6F62616C44617461220000095661726961626C657301010C16000000204E616D653D2220557365722043617465676F72792200010C2A000000204E616D653D2250506572696F64222056616C75653D2227CBE8F1F2EEEFE0E4203230303520F02E27220000055374796C650100">
  <TfrxReportPage Name="Page1" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="25" RightMargin="10" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="">
    <TfrxGroupHeader Name="GroupHeader1" Height="95,81107" Left="0" Top="79,37013" Width="661,41775" OnAfterCalcHeight="GroupHeader1OnAfterCalcHeight" OnBeforePrint="GroupHeader1OnBeforePrint" Condition="ReportDsetData.&#34;KOD_VIDOPL&#34;" KeepChild="True" KeepTogether="True" ReprintOnNewPage="True" StartNewPage="True" Stretched="True">
      <TfrxMemoView Name="Memo1" Left="0" Top="51" Width="714,33117" Height="18,89765" AllowHTMLTags="True" DataSet="ReportDsetData" DataSetName="ReportDsetData" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Memo.Text="Вид:   &#60;b&#62;[ReportDsetData.&#34;KOD_VIDOPL&#34;] - [ReportDsetData.&#34;NAME_VIDOPL&#34;]&#60;/b&#62;" ParentFont="False"/>
      <TfrxMemoView Name="Memo11" Left="514,01608" Top="76,91342" Width="109,60637" Height="18,89765" DataSet="ReportDsetData" DataSetName="ReportDsetData" DisplayFormat.DecimalSeparator="." DisplayFormat.FormatStr="%2.2f" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" Memo.Text="Сума" ParentFont="False"/>
      <TfrxSysMemoView Name="SysMemo2" Left="0" Top="76,91342" Width="49,13389" Height="18,89765" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" Memo.Text="№ пп." ParentFont="False"/>
      <TfrxMemoView Name="Memo12" Left="49,13389" Top="76,91342" Width="75,5906" Height="18,89765" DataSet="ReportDsetData" DataSetName="ReportDsetData" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" Memo.Text="Таб. номер" ParentFont="False"/>
      <TfrxMemoView Name="Memo13" Left="124,72449" Top="76,91342" Width="389,29159" Height="18,89765" DataSet="ReportDsetData" DataSetName="ReportDsetData" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" Memo.Text="Прізвище, Ім'я, По-батькові" ParentFont="False"/>
      <TfrxMemoView Name="Memo17" Left="-37,7953" Top="0" Width="715,81253" Height="26,45671" StretchMode="smMaxHeight" AllowHTMLTags="True" DataSet="ReportDSetGlobalData" DataSetName="ReportDsetGlobalData" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Arial" Font.Style="0" HAlign="haCenter" Memo.Text="Реєстр: &#60;b&#62;&#34;[ReportDsetGlobalData.&#34;NAME_VOPL_PROP&#34;]&#34;&#60;/b&#62;" ParentFont="False"/>
      <TfrxMemoView Name="Memo18" Left="83,14966" Top="26,45671" Width="423,30736" Height="18,89765" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" HAlign="haCenter" Memo.Text="[PPeriod]" ParentFont="False"/>
      <TfrxSysMemoView Name="SysMemo5" Left="506,45702" Top="26,45671" Width="113,3859" Height="18,89765" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="2" HAlign="haRight" Memo.Text="стор. [PAGE#] " ParentFont="False"/>
      <TfrxMemoView Name="Memo19" Left="0" Top="26,45671" Width="79,37013" Height="18,89765" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Memo.Text="[Date]" ParentFont="False"/>
      <TfrxLineView Name="Line1" Left="0" Top="48,13389" Width="625,40198" Height="0" Frame.Typ="4"/>
    </TfrxGroupHeader>
    <TfrxMasterData Name="MasterData1" Height="18,89765" Left="0" Top="196,53556" Width="661,41775" OnAfterCalcHeight="MasterData1OnAfterCalcHeight" OnBeforePrint="MasterData1OnBeforePrint" ColumnWidth="0" ColumnGap="0" DataSet="ReportDsetData" DataSetName="ReportDsetData" KeepFooter="True" KeepHeader="True" KeepTogether="True" RowCount="0">
      <TfrxMemoView Name="Memo3" Left="514,01608" Top="0" Width="109,60637" Height="18,89765" DataField="SUMMA" DataSet="ReportDsetData" DataSetName="ReportDsetData" DisplayFormat.DecimalSeparator="." DisplayFormat.FormatStr="%2.2f" DisplayFormat.Kind="fkNumeric" Frame.Typ="15" HAlign="haRight" Memo.Text="[ReportDsetData.&#34;SUMMA&#34;]"/>
      <TfrxMemoView Name="Memo24" Left="49,13389" Top="0" Width="75,5906" Height="18,89765" DataField="TN" DataSet="ReportDsetData" DataSetName="ReportDsetData" Frame.Typ="15" HAlign="haCenter" Memo.Text="[ReportDsetData.&#34;TN&#34;]"/>
      <TfrxMemoView Name="Memo10" Left="124,72449" Top="0" Width="389,29159" Height="18,89765" DataField="FIO" DataSet="ReportDsetData" DataSetName="ReportDsetData" Frame.Typ="14" Memo.Text="[ReportDsetData.&#34;FIO&#34;]"/>
      <TfrxMemoView Name="Memo4" Left="0" Top="0" Width="49,13389" Height="18,89765" Frame.Typ="15" HAlign="haRight" Memo.Text="[PLine]"/>
    </TfrxMasterData>
    <TfrxGroupFooter Name="GroupFooter1" Height="68,03154" Left="0" Top="238,11039" Width="661,41775" OnBeforePrint="GroupFooter1OnBeforePrint">
      <TfrxSysMemoView Name="SysMemo3" Left="514,01608" Top="0" Width="109,60637" Height="18,89765" DisplayFormat.DecimalSeparator="." DisplayFormat.FormatStr="%2.2f" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haRight" Memo.Text="[SUM(&#60;ReportDsetData.&#34;SUMMA&#34;&#62;,MasterData1)]" ParentFont="False"/>
      <TfrxMemoView Name="Memo20" Left="0" Top="0" Width="514,01608" Height="18,89765" DataSet="ReportDsetData" DataSetName="ReportDsetData" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" Memo.Text="Загалом:" ParentFont="False"/>
      <TfrxMemoView Name="Memo2" Left="0" Top="27,67718" Width="204,09462" Height="18,89765" DataField="DIRECTOR_POST" DataSet="ReportDSetGlobalData" DataSetName="ReportDsetGlobalData" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Memo.Text="[ReportDsetGlobalData.&#34;DIRECTOR_POST&#34;]" ParentFont="False"/>
      <TfrxMemoView Name="Memo21" Left="0" Top="50,35436" Width="204,09462" Height="18,89765" DataField="GLBUHG_POST" DataSet="ReportDSetGlobalData" DataSetName="ReportDsetGlobalData" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Memo.Text="[ReportDsetGlobalData.&#34;GLBUHG_POST&#34;]" ParentFont="False"/>
      <TfrxMemoView Name="Memo22" Left="449,76407" Top="28,45671" Width="173,85838" Height="18,89765" DataField="DIRECTOR" DataSet="ReportDSetGlobalData" DataSetName="ReportDsetGlobalData" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="3" HAlign="haRight" Memo.Text="[ReportDsetGlobalData.&#34;DIRECTOR&#34;]" ParentFont="False"/>
      <TfrxMemoView Name="Memo23" Left="449,76407" Top="51,13389" Width="173,85838" Height="18,89765" DataField="GLBUHG" DataSet="ReportDSetGlobalData" DataSetName="ReportDsetGlobalData" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="3" HAlign="haRight" Memo.Text="[ReportDsetGlobalData.&#34;GLBUHG&#34;]" ParentFont="False"/>
      <TfrxLineView Name="Line2" Left="204,09462" Top="42,7953" Width="245,66945" Height="0" Frame.Typ="4"/>
      <TfrxLineView Name="Line3" Left="204,09462" Top="65,47248" Width="245,66945" Height="0" Frame.Typ="4"/>
    </TfrxGroupFooter>
    <TfrxPageFooter Name="PageFooter1" Height="18,89765" Left="0" Top="389,29159" Width="661,41775" OnBeforePrint="PageFooter1OnBeforePrint">
      <TfrxSysMemoView Name="SysMemo4" Left="415,7483" Top="0" Width="151,1812" Height="18,89765" DisplayFormat.DecimalSeparator="." DisplayFormat.FormatStr="%2.2f" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" HAlign="haRight" Memo.Text="[SUM(&#60;ReportDsetData.&#34;SUMMA&#34;&#62;,MasterData1)]" ParentFont="False"/>
      <TfrxMemoView Name="Memo15" Left="0" Top="0" Width="415,7483" Height="18,89765" DataSet="ReportDsetData" DataSetName="ReportDsetData" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" HAlign="haRight" Memo.Text="Загалом по листу:" ParentFont="False"/>
    </TfrxPageFooter>
    <TfrxReportTitle Name="ReportTitle1" Height="0" Left="0" Top="18,89765" Width="661,41775" OnBeforePrint="ReportTitle1OnBeforePrint"/>
    <TfrxReportSummary Name="ReportSummary1" Height="0" Left="0" Top="366,61441" Width="661,41775" OnAfterCalcHeight="ReportSummary1OnAfterCalcHeight"/>
  </TfrxReportPage>
</TfrxReport>
